<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>draw</title>
    <style>
        body { margin: 0; }
        canvas { width: 100%!important; height: auto!important; }
    </style>
</head>
<body>
<script src="js/three.js"></script>
<script src="js/dat.gui.js"></script>
<script src="js/papaparse.js"></script>
<script>
    //Set scene size
    var WINDOW_WIDTH = window.innerWidth;
    var WINDOW_HEIGHT = window.innerHeight;

    // 1 Meter in Realit√§t ist <10> Pixel auf einem Bild
    //meter/pixel
    var scale = 1/100;

    var bgImgWidth;
    var bgImgHeight;
    var bgImgRatio = WINDOW_WIDTH / WINDOW_HEIGHT;




    //Set camera attributes
    var LEFT = WINDOW_WIDTH / -2;
    var RIGHT = WINDOW_WIDTH / 2;
    var TOP = WINDOW_HEIGHT / 2;
    var BOTTOM = WINDOW_HEIGHT / -2;
    var NEAR = -500;
    var FAR = 1000;

    //container
    var container;

    //Background image
    var backgroundMesh;



    //CoordSys
    var FRAME_COORDSYS = 0;
    var V_LEFT_CORR = - ((WINDOW_WIDTH / 2) - FRAME_COORDSYS);
    var V_TOP_CORR = (WINDOW_HEIGHT / 2) - FRAME_COORDSYS;
    var V_RIGHT_CORR = (WINDOW_WIDTH / 2) - FRAME_COORDSYS;
    var V_BOTTOM_CORR = - ((WINDOW_HEIGHT / 2) - FRAME_COORDSYS);
    var SCALE_STROKE_D = WINDOW_WIDTH / 40; //space between two scale strokes
    var coordSys;

    //three.js
    var camera, scene, renderer;

    //dat.gui
    var gui;

    initialize();
    update();

    function initialize(){

//        container = document.createElement('div');
//        document.body.appendChild(container);

        scene = new THREE.Scene();

        initBgImg();

        initGrid();

        initCamera();

        initRenderer();

        initDatGUI();



        addWindowListeners();
    }

    function initBgImg(){
        var bgMaterial = new THREE.MeshBasicMaterial();

        var bgLoader = new THREE.TextureLoader();
        bgLoader.load(
            'img/indoors-office.png',
            function ( texture ) {
                bgMaterial = new THREE.MeshBasicMaterial({
                    //map: texture
                    //wireframe: true
                    color: 0x550011
                });
                bgImgWidth = texture.image.naturalWidth;
                bgImgHeight = texture.image.naturalHeight;
                bgImgRatio = bgImgWidth / bgImgHeight;

                var backgroundPlane = new THREE.Geometry();
                backgroundPlane.vertices.push(new THREE.Vector3(V_LEFT_CORR, V_TOP_CORR, 0.5));
                backgroundPlane.vertices.push(new THREE.Vector3(V_LEFT_CORR, V_BOTTOM_CORR, 0.5));
                backgroundPlane.vertices.push(new THREE.Vector3(V_RIGHT_CORR, V_BOTTOM_CORR, 0.5));
                backgroundPlane.vertices.push(new THREE.Vector3(V_RIGHT_CORR, V_TOP_CORR, 0.5));
                backgroundPlane.faces.push(new THREE.Face3(0,1,3));
                backgroundPlane.faces.push(new THREE.Face3(1,2,3));
                backgroundPlane.computeFaceNormals();

                backgroundMesh = new THREE.Mesh(
                    //new THREE.PlaneGeometry(WINDOW_WIDTH, WINDOW_WIDTH / bgImgRatio),

                    backgroundPlane,
                    bgMaterial

                );

                //backgroundMesh.translateY((WINDOW_HEIGHT/2) - );
                scene.add(backgroundMesh);
            },
            function () {},
            function () {
                console.log('bg-loading failed');
            }
        );
     }

    function initGrid(){

        var coordGeometry = new THREE.Geometry();

        //x-axis
        for (i = 0; i < (WINDOW_WIDTH - FRAME_COORDSYS); i += (WINDOW_WIDTH / 40)) {
            coordGeometry.vertices.push(new THREE.Vector3(V_LEFT_CORR, V_TOP_CORR - i, 1));
            coordGeometry.vertices.push(new THREE.Vector3(V_RIGHT_CORR, V_TOP_CORR - i, 1));
        }
        //y-axis
        for (i = 0; i < (WINDOW_HEIGHT - FRAME_COORDSYS); i += (WINDOW_WIDTH / 40)) {
            coordGeometry.vertices.push(new THREE.Vector3(V_LEFT_CORR + i, V_TOP_CORR, 1));
            coordGeometry.vertices.push(new THREE.Vector3(V_LEFT_CORR + i, V_BOTTOM_CORR, 1));
        }

        var coordMaterial = new THREE.LineBasicMaterial({color: 0xff0000, opacity: 1, linewidth: 1});
        var coordLines = new THREE.LineSegments(coordGeometry, coordMaterial);

        scene.add(coordLines);
    }

    function initCamera(){
        camera = new THREE.OrthographicCamera(LEFT, RIGHT, TOP, BOTTOM, NEAR, FAR);
        camera.aspect = WINDOW_WIDTH / WINDOW_HEIGHT;
    }
    function updateCamera(){
        camera.aspect = WINDOW_WIDTH / WINDOW_HEIGHT;
        camera.updateProjectionMatrix();
    }

    function initRenderer(){
        renderer = new THREE.WebGLRenderer({antialias: true, alpha: true});
        renderer.setClearColor(0xffffff, 0);
        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.setSize(WINDOW_WIDTH, WINDOW_HEIGHT);
//        container.appendChild(renderer.domElement);
        document.body.appendChild(renderer.domElement);
    }
    function updateRenderer(){
        renderer.setSize(WINDOW_WIDTH, WINDOW_HEIGHT);
    }

    function initDatGUI(){
        gui = new dat.GUI();
        //gui.add(coordSys, )
    }
    function addWindowListeners(){
        window.addEventListener('resize', onWindowResize, false);
    }

    function onWindowResize () {
        WINDOW_HEIGHT = window.innerHeight;
        WINDOW_WIDTH = window.innerWidth;

        //document.getElementsByTagName('canvas').style.width = '100%!important';

        updateCamera();
        updateRenderer();
    }

    function update () {
        requestAnimationFrame(update);
        renderer.render(scene, camera);
    }

</script>



</body>
</html>