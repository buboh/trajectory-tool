<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>draw</title>
    <style>
        body { margin: 0; }
        canvas { width: 100%!important; }
    </style>
</head>
<body>
<script src="js/three.js"></script>
<script src="js/dat.gui.js"></script>
<script src="js/papaparse.js"></script>
<script>
    //Set scene size
    var WIDTH = window.innerWidth;
    var HEIGHT = window.innerHeight;

    //Set camera attributes
    var LEFT = WIDTH / -2;
    var RIGHT = WIDTH / 2;
    var TOP = HEIGHT / 2;
    var BOTTOM = HEIGHT / -2;
    var NEAR = -500;
    var FAR = 1000;

    //container
    var container;

    //Background image
    var backgroundMesh;
    var bgImgWidth;
    var bgImgHeight;
    var bgImgRatio = WIDTH / HEIGHT;

    //CoordSys
    var FRAME_COORDSYS = 10;
    var V_LEFT_CORR = - ((WIDTH / 2) - FRAME_COORDSYS);
    var V_TOP_CORR = (HEIGHT / 2) - FRAME_COORDSYS;
    var V_RIGHT_CORR = (WIDTH / 2) - FRAME_COORDSYS;
    var V_BOTTOM_CORR = - ((HEIGHT / 2) - FRAME_COORDSYS);
    var SCALE_STROKE_D = WIDTH / 40; //space between two scale strokes
    var coordSys;

    //three.js
    var camera, scene, renderer;

    //dat.gui
    var gui;

    initialize();
    update();

    function initialize(){

        container = document.createElement('div');
        document.body.appendChild(container);

        scene = new THREE.Scene();

        initBgImg();

        initCoordSys();

        initCamera();

        initRenderer();

        initDatGUI();



        addWindowListeners();
    }

    function initBgImg(){
        var bgMaterial = new THREE.MeshBasicMaterial();

        var bgLoader = new THREE.TextureLoader();
        bgLoader.load(
            'img/indoors-office.png',
            function ( texture ) {
                bgMaterial = new THREE.MeshBasicMaterial({
                    map: texture
                });
                bgImgWidth = texture.image.naturalWidth;
                bgImgHeight = texture.image.naturalHeight;
                bgImgRatio = bgImgWidth / bgImgHeight;

                backgroundMesh = new THREE.Mesh(
                    new THREE.PlaneGeometry(WIDTH, WIDTH / bgImgRatio),
                    bgMaterial
                );

                //backgroundMesh.translateY((HEIGHT/2) - );
                scene.add(backgroundMesh);
            },
            function () {},
            function () {
                console.log('bg-loading failed');
            }
        );
    }
    function updateBg(){

    }

    function initCoordSys(){

        var coordGeometry = new THREE.Geometry();

        //x-axis
        for (i = 0; i < (WIDTH - FRAME_COORDSYS * 2); i += SCALE_STROKE_D) {
            coordGeometry.vertices.push(new THREE.Vector3(V_LEFT_CORR, V_TOP_CORR - i, 1));
            coordGeometry.vertices.push(new THREE.Vector3(V_RIGHT_CORR, V_TOP_CORR - i, 1));
        }
        //y-axis
        for (i = 0; i < (HEIGHT - FRAME_COORDSYS * 2); i += SCALE_STROKE_D) {
            coordGeometry.vertices.push(new THREE.Vector3(V_LEFT_CORR + i, V_TOP_CORR, 1));
            coordGeometry.vertices.push(new THREE.Vector3(V_LEFT_CORR + i, V_BOTTOM_CORR, 1));
        }

        var coordMaterial = new THREE.LineBasicMaterial({color: 0xff0000, opacity: 1, linewidth: 1});
        var coordLines = new THREE.LineSegments(coordGeometry, coordMaterial);

        scene.add(coordLines);
    }

    function initCamera(){
        camera = new THREE.OrthographicCamera(LEFT, RIGHT, TOP, BOTTOM, NEAR, FAR);
        camera.aspect = WIDTH / HEIGHT;
    }
    function updateCamera(){
        camera.aspect = WIDTH / HEIGHT;
        camera.updateProjectionMatrix();
    }

    function initRenderer(){
        renderer = new THREE.WebGLRenderer({antialias: true, alpha: true});
        renderer.setClearColor(0xffffff, 0);
        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.setSize(WIDTH, HEIGHT);
        container.appendChild(renderer.domElement);
    }
    function updateRenderer(){
        renderer.setSize(WIDTH, HEIGHT);
    }

    function initDatGUI(){
        gui = new dat.GUI();
        //gui.add(coordSys, )
    }
    function addWindowListeners(){
        window.addEventListener('resize', onWindowResize, false);
    }

    function onWindowResize () {
        HEIGHT = window.innerHeight;
        WIDTH = window.innerWidth;

        updateBg();
        updateCamera();
        updateRenderer();
    }

    function update () {
        requestAnimationFrame(update);
        renderer.render(scene, camera);
    }

</script>



</body>
</html>